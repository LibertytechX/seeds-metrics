/**
 * Mock data for the dashboard
 */

import {
  calculateFIMR,
  calculateD0to6Slippage,
  calculateRoll,
  calculateFRR,
  calculateAYR,
  calculateDQI,
  calculateRiskScore,
} from './metrics';

const officers = [
  {
    id: 1,
    name: 'John Doe',
    region: 'Lagos',
    branch: 'Lagos Main',
    channel: 'Direct',
    // Raw metrics
    firstMiss: 150,
    disbursed: 5000,
    dpd1to6Bal: 250000,
    amountDue7d: 5000000,
    movedTo7to30: 180000,
    prevDpd1to6Bal: 720000,
    feesCollected: 450000,
    feesDue: 500000,
    interestCollected: 2100000,
    overdue15d: 1200000,
    totalPortfolio: 50000000,
    par15MidMonth: 4500000, // PAR15 exposure at mid-month
    riskScoreNorm: 0.85,
    onTimeRate: 0.92,
    channelPurity: 0.95,
    porr: 0.02,
    waivers: 50000,
    backdated: 5,
    entries: 200,
    reversals: 2,
    hadFloatGap: false,
  },
  {
    id: 2,
    name: 'Grace Okon',
    region: 'Abuja',
    branch: 'Abuja Central',
    channel: 'Partner',
    firstMiss: 280,
    disbursed: 4200,
    dpd1to6Bal: 450000,
    amountDue7d: 4500000,
    movedTo7to30: 320000,
    prevDpd1to6Bal: 800000,
    feesCollected: 320000,
    feesDue: 500000,
    interestCollected: 1500000,
    overdue15d: 2800000,
    totalPortfolio: 45000000,
    par15MidMonth: 6200000, // PAR15 exposure at mid-month
    riskScoreNorm: 0.65,
    onTimeRate: 0.78,
    channelPurity: 0.80,
    porr: 0.06,
    waivers: 120000,
    backdated: 12,
    entries: 180,
    reversals: 5,
    hadFloatGap: true,
  },
  {
    id: 3,
    name: 'Musa Adebayo',
    region: 'Kano',
    branch: 'Kano North',
    channel: 'Direct',
    firstMiss: 420,
    disbursed: 3800,
    dpd1to6Bal: 680000,
    amountDue7d: 3800000,
    movedTo7to30: 520000,
    prevDpd1to6Bal: 1200000,
    feesCollected: 180000,
    feesDue: 500000,
    interestCollected: 900000,
    overdue15d: 4200000,
    totalPortfolio: 35000000,
    par15MidMonth: 3600000, // PAR15 exposure at mid-month
    riskScoreNorm: 0.45,
    onTimeRate: 0.62,
    channelPurity: 0.65,
    porr: 0.12,
    waivers: 250000,
    backdated: 25,
    entries: 150,
    reversals: 10,
    hadFloatGap: true,
  },
];

// Calculate derived metrics for each officer
export const generateOfficerMetrics = (officer) => {
  const fimr = calculateFIMR(officer.firstMiss, officer.disbursed);
  const slippage = calculateD0to6Slippage(officer.dpd1to6Bal, officer.amountDue7d);
  const roll = calculateRoll(officer.movedTo7to30, officer.prevDpd1to6Bal);
  const frr = calculateFRR(officer.feesCollected, officer.feesDue);
  const ayr = calculateAYR(
    officer.interestCollected,
    officer.feesCollected,
    officer.par15MidMonth
  );
  const dqi = calculateDQI(
    officer.riskScoreNorm,
    officer.onTimeRate,
    fimr,
    officer.channelPurity,
    true
  );
  const riskScore = calculateRiskScore({
    porr: officer.porr,
    fimr,
    roll,
    waivers: officer.waivers,
    amountDue7d: officer.amountDue7d,
    backdated: officer.backdated,
    entries: officer.entries,
    reversals: officer.reversals,
    frr,
    channelPurity: officer.channelPurity,
    hadFloatGap: officer.hadFloatGap,
  });

  return {
    ...officer,
    fimr,
    slippage,
    roll,
    frr,
    ayr,
    dqi,
    riskScore,
    yield: officer.interestCollected + officer.feesCollected,
    overdue15dVolume: officer.overdue15d,
  };
};

export const mockOfficers = officers.map(generateOfficerMetrics);

export const mockPortfolioMetrics = {
  totalOverdue15d: mockOfficers.reduce((sum, o) => sum + o.overdue15d, 0),
  avgDQI: Math.round(mockOfficers.reduce((sum, o) => sum + o.dqi, 0) / mockOfficers.length),
  avgAYR: (mockOfficers.reduce((sum, o) => sum + o.ayr, 0) / mockOfficers.length).toFixed(2),
  avgRiskScore: Math.round(mockOfficers.reduce((sum, o) => sum + o.riskScore, 0) / mockOfficers.length),
  topOfficer: mockOfficers.reduce((best, o) => (o.ayr > best.ayr ? o : best)),
  watchlistCount: mockOfficers.filter(o => o.riskScore < 80).length,
};

export const mockLoans = [
  { id: 101, officerId: 1, amount: 500000, daysOverdue: 0, status: 'Current', channel: 'Direct' },
  { id: 102, officerId: 1, amount: 300000, daysOverdue: 5, status: 'Early', channel: 'Direct' },
  { id: 103, officerId: 2, amount: 450000, daysOverdue: 20, status: 'Overdue', channel: 'Partner' },
  { id: 104, officerId: 3, amount: 600000, daysOverdue: 35, status: 'Overdue', channel: 'Direct' },
];

/**
 * Mock data for FIMR Drilldown - Loans that missed their first installment
 */
export const mockFIMRLoans = [
  {
    loanId: 'LN-2024-001',
    officerName: 'John Doe',
    region: 'Lagos',
    branch: 'Lagos Main',
    customerName: 'Adebayo Ogunlesi',
    customerPhone: '+234-803-456-7890',
    disbursementDate: '2024-09-15',
    loanAmount: 500000,
    firstPaymentDueDate: '2024-10-01',
    daysSinceDue: 47,
    amountDue1stInstallment: 62500,
    amountPaid: 0,
    outstandingBalance: 500000,
    currentDPD: 47,
    channel: 'Direct',
    status: 'First Payment Missed',
    fimrTagged: true,
  },
  {
    loanId: 'LN-2024-002',
    officerName: 'John Doe',
    region: 'Lagos',
    branch: 'Lagos Main',
    customerName: 'Chioma Nwosu',
    customerPhone: '+234-701-234-5678',
    disbursementDate: '2024-09-20',
    loanAmount: 350000,
    firstPaymentDueDate: '2024-10-05',
    daysSinceDue: 42,
    amountDue1stInstallment: 43750,
    amountPaid: 20000,
    outstandingBalance: 330000,
    currentDPD: 42,
    channel: 'Direct',
    status: 'Partially Paid',
    fimrTagged: true,
  },
  {
    loanId: 'LN-2024-003',
    officerName: 'Grace Okon',
    region: 'Abuja',
    branch: 'Abuja Central',
    customerName: 'Ibrahim Musa',
    customerPhone: '+234-805-987-6543',
    disbursementDate: '2024-09-10',
    loanAmount: 750000,
    firstPaymentDueDate: '2024-09-25',
    daysSinceDue: 52,
    amountDue1stInstallment: 93750,
    amountPaid: 0,
    outstandingBalance: 750000,
    currentDPD: 52,
    channel: 'Partner',
    status: 'First Payment Missed',
    fimrTagged: true,
  },
  {
    loanId: 'LN-2024-004',
    officerName: 'Grace Okon',
    region: 'Abuja',
    branch: 'Abuja Central',
    customerName: 'Fatima Bello',
    customerPhone: '+234-809-123-4567',
    disbursementDate: '2024-09-25',
    loanAmount: 420000,
    firstPaymentDueDate: '2024-10-10',
    daysSinceDue: 37,
    amountDue1stInstallment: 52500,
    amountPaid: 0,
    outstandingBalance: 420000,
    currentDPD: 37,
    channel: 'Partner',
    status: 'First Payment Missed',
    fimrTagged: true,
  },
  {
    loanId: 'LN-2024-005',
    officerName: 'Musa Adebayo',
    region: 'Kano',
    branch: 'Kano North',
    customerName: 'Oluwaseun Adeyemi',
    customerPhone: '+234-706-555-8901',
    disbursementDate: '2024-09-05',
    loanAmount: 600000,
    firstPaymentDueDate: '2024-09-20',
    daysSinceDue: 57,
    amountDue1stInstallment: 75000,
    amountPaid: 0,
    outstandingBalance: 600000,
    currentDPD: 57,
    channel: 'Direct',
    status: 'Defaulted',
    fimrTagged: true,
  },
  {
    loanId: 'LN-2024-006',
    officerName: 'Musa Adebayo',
    region: 'Kano',
    branch: 'Kano North',
    customerName: 'Blessing Okoro',
    customerPhone: '+234-802-345-6789',
    disbursementDate: '2024-09-18',
    loanAmount: 280000,
    firstPaymentDueDate: '2024-10-03',
    daysSinceDue: 44,
    amountDue1stInstallment: 35000,
    amountPaid: 15000,
    outstandingBalance: 265000,
    currentDPD: 44,
    channel: 'Direct',
    status: 'Partially Paid',
    fimrTagged: true,
  },
  {
    loanId: 'LN-2024-007',
    officerName: 'John Doe',
    region: 'Lagos',
    branch: 'Lagos Main',
    customerName: 'Emeka Okafor',
    customerPhone: '+234-813-678-9012',
    disbursementDate: '2024-09-22',
    loanAmount: 550000,
    firstPaymentDueDate: '2024-10-07',
    daysSinceDue: 40,
    amountDue1stInstallment: 68750,
    amountPaid: 0,
    outstandingBalance: 550000,
    currentDPD: 40,
    channel: 'Direct',
    status: 'First Payment Missed',
    fimrTagged: true,
  },
  {
    loanId: 'LN-2024-008',
    officerName: 'Grace Okon',
    region: 'Abuja',
    branch: 'Abuja Central',
    customerName: 'Aisha Mohammed',
    customerPhone: '+234-704-890-1234',
    disbursementDate: '2024-09-12',
    loanAmount: 390000,
    firstPaymentDueDate: '2024-09-27',
    daysSinceDue: 50,
    amountDue1stInstallment: 48750,
    amountPaid: 10000,
    outstandingBalance: 380000,
    currentDPD: 50,
    channel: 'Partner',
    status: 'Partially Paid',
    fimrTagged: true,
  },
  {
    loanId: 'LN-2024-009',
    officerName: 'Musa Adebayo',
    region: 'Kano',
    branch: 'Kano North',
    customerName: 'Ngozi Eze',
    customerPhone: '+234-807-234-5678',
    disbursementDate: '2024-09-08',
    loanAmount: 480000,
    firstPaymentDueDate: '2024-09-23',
    daysSinceDue: 54,
    amountDue1stInstallment: 60000,
    amountPaid: 0,
    outstandingBalance: 480000,
    currentDPD: 54,
    channel: 'Direct',
    status: 'Defaulted',
    fimrTagged: true,
  },
  {
    loanId: 'LN-2024-010',
    officerName: 'John Doe',
    region: 'Lagos',
    branch: 'Lagos Main',
    customerName: 'Yusuf Abdullahi',
    customerPhone: '+234-810-567-8901',
    disbursementDate: '2024-09-28',
    loanAmount: 320000,
    firstPaymentDueDate: '2024-10-13',
    daysSinceDue: 34,
    amountDue1stInstallment: 40000,
    amountPaid: 0,
    outstandingBalance: 320000,
    currentDPD: 34,
    channel: 'Direct',
    status: 'First Payment Missed',
    fimrTagged: true,
  },
  {
    loanId: 'LN-2024-011',
    officerName: 'Grace Okon',
    region: 'Abuja',
    branch: 'Abuja Central',
    customerName: 'Tunde Bakare',
    customerPhone: '+234-708-345-6789',
    disbursementDate: '2024-09-16',
    loanAmount: 670000,
    firstPaymentDueDate: '2024-10-01',
    daysSinceDue: 46,
    amountDue1stInstallment: 83750,
    amountPaid: 30000,
    outstandingBalance: 640000,
    currentDPD: 46,
    channel: 'Partner',
    status: 'Partially Paid',
    fimrTagged: true,
  },
  {
    loanId: 'LN-2024-012',
    officerName: 'Musa Adebayo',
    region: 'Kano',
    branch: 'Kano North',
    customerName: 'Kemi Adeleke',
    customerPhone: '+234-815-901-2345',
    disbursementDate: '2024-09-30',
    loanAmount: 410000,
    firstPaymentDueDate: '2024-10-15',
    daysSinceDue: 32,
    amountDue1stInstallment: 51250,
    amountPaid: 0,
    outstandingBalance: 410000,
    currentDPD: 32,
    channel: 'Direct',
    status: 'First Payment Missed',
    fimrTagged: true,
  },
];

/**
 * Mock data for Early Indicators Drilldown - Loans in D0-6 or rolled to D7-30
 */
export const mockEarlyIndicatorLoans = [
  {
    loanId: 'LN-2024-101',
    officerName: 'John Doe',
    region: 'Lagos',
    branch: 'Lagos Main',
    customerName: 'Chidi Okafor',
    customerPhone: '+234-816-234-5678',
    disbursementDate: '2024-08-20',
    loanAmount: 450000,
    currentDPD: 5,
    previousDPDStatus: 'D1-3',
    daysInCurrentStatus: 2,
    amountDue: 56250,
    amountPaid: 0,
    outstandingBalance: 450000,
    channel: 'Direct',
    status: 'D4-6',
    fimrTagged: true,
    rollDirection: 'Worsening',
    lastPaymentDate: '2024-08-25',
  },
  {
    loanId: 'LN-2024-102',
    officerName: 'John Doe',
    region: 'Lagos',
    branch: 'Lagos Main',
    customerName: 'Amina Bello',
    customerPhone: '+234-703-567-8901',
    disbursementDate: '2024-09-01',
    loanAmount: 320000,
    currentDPD: 2,
    previousDPDStatus: 'Current',
    daysInCurrentStatus: 2,
    amountDue: 40000,
    amountPaid: 0,
    outstandingBalance: 320000,
    channel: 'Direct',
    status: 'D1-3',
    fimrTagged: false,
    rollDirection: 'Worsening',
    lastPaymentDate: '2024-09-05',
  },
  {
    loanId: 'LN-2024-103',
    officerName: 'Grace Okon',
    region: 'Abuja',
    branch: 'Abuja Central',
    customerName: 'Tunde Adeyemi',
    customerPhone: '+234-809-890-1234',
    disbursementDate: '2024-08-15',
    loanAmount: 580000,
    currentDPD: 12,
    previousDPDStatus: 'D4-6',
    daysInCurrentStatus: 6,
    amountDue: 72500,
    amountPaid: 20000,
    outstandingBalance: 560000,
    channel: 'Partner',
    status: 'Rolled to D7-15',
    fimrTagged: true,
    rollDirection: 'Worsening',
    lastPaymentDate: '2024-09-10',
  },
  {
    loanId: 'LN-2024-104',
    officerName: 'Grace Okon',
    region: 'Abuja',
    branch: 'Abuja Central',
    customerName: 'Blessing Eze',
    customerPhone: '+234-812-345-6789',
    disbursementDate: '2024-09-05',
    loanAmount: 410000,
    currentDPD: 6,
    previousDPDStatus: 'D1-3',
    daysInCurrentStatus: 3,
    amountDue: 51250,
    amountPaid: 10000,
    outstandingBalance: 400000,
    channel: 'Partner',
    status: 'D4-6',
    fimrTagged: false,
    rollDirection: 'Worsening',
    lastPaymentDate: '2024-09-20',
  },
  {
    loanId: 'LN-2024-105',
    officerName: 'Musa Adebayo',
    region: 'Kano',
    branch: 'Kano North',
    customerName: 'Funke Oladipo',
    customerPhone: '+234-805-123-4567',
    disbursementDate: '2024-08-25',
    loanAmount: 350000,
    currentDPD: 18,
    previousDPDStatus: 'D7-15',
    daysInCurrentStatus: 3,
    amountDue: 43750,
    amountPaid: 0,
    outstandingBalance: 350000,
    channel: 'Direct',
    status: 'Rolled to D16-30',
    fimrTagged: true,
    rollDirection: 'Worsening',
    lastPaymentDate: '2024-09-01',
  },
  {
    loanId: 'LN-2024-106',
    officerName: 'Musa Adebayo',
    region: 'Kano',
    branch: 'Kano North',
    customerName: 'Ibrahim Yusuf',
    customerPhone: '+234-814-678-9012',
    disbursementDate: '2024-09-10',
    loanAmount: 290000,
    currentDPD: 4,
    previousDPDStatus: 'D1-3',
    daysInCurrentStatus: 1,
    amountDue: 36250,
    amountPaid: 5000,
    outstandingBalance: 285000,
    channel: 'Direct',
    status: 'D4-6',
    fimrTagged: false,
    rollDirection: 'Worsening',
    lastPaymentDate: '2024-09-25',
  },
  {
    loanId: 'LN-2024-107',
    officerName: 'John Doe',
    region: 'Lagos',
    branch: 'Lagos Main',
    customerName: 'Ngozi Okeke',
    customerPhone: '+234-706-789-0123',
    disbursementDate: '2024-09-12',
    loanAmount: 520000,
    currentDPD: 3,
    previousDPDStatus: 'Current',
    daysInCurrentStatus: 3,
    amountDue: 65000,
    amountPaid: 0,
    outstandingBalance: 520000,
    channel: 'Direct',
    status: 'D1-3',
    fimrTagged: false,
    rollDirection: 'Worsening',
    lastPaymentDate: '2024-09-18',
  },
  {
    loanId: 'LN-2024-108',
    officerName: 'Grace Okon',
    region: 'Abuja',
    branch: 'Abuja Central',
    customerName: 'Yusuf Mohammed',
    customerPhone: '+234-811-234-5678',
    disbursementDate: '2024-08-18',
    loanAmount: 640000,
    currentDPD: 10,
    previousDPDStatus: 'D4-6',
    daysInCurrentStatus: 4,
    amountDue: 80000,
    amountPaid: 15000,
    outstandingBalance: 625000,
    channel: 'Partner',
    status: 'Rolled to D7-15',
    fimrTagged: true,
    rollDirection: 'Worsening',
    lastPaymentDate: '2024-09-05',
  },
  {
    loanId: 'LN-2024-109',
    officerName: 'Musa Adebayo',
    region: 'Kano',
    branch: 'Kano North',
    customerName: 'Chioma Nwankwo',
    customerPhone: '+234-808-456-7890',
    disbursementDate: '2024-09-08',
    loanAmount: 380000,
    currentDPD: 5,
    previousDPDStatus: 'D1-3',
    daysInCurrentStatus: 2,
    amountDue: 47500,
    amountPaid: 0,
    outstandingBalance: 380000,
    channel: 'Direct',
    status: 'D4-6',
    fimrTagged: false,
    rollDirection: 'Worsening',
    lastPaymentDate: '2024-09-22',
  },
  {
    loanId: 'LN-2024-110',
    officerName: 'John Doe',
    region: 'Lagos',
    branch: 'Lagos Main',
    customerName: 'Fatima Abubakar',
    customerPhone: '+234-702-567-8901',
    disbursementDate: '2024-08-22',
    loanAmount: 470000,
    currentDPD: 15,
    previousDPDStatus: 'D7-15',
    daysInCurrentStatus: 1,
    amountDue: 58750,
    amountPaid: 25000,
    outstandingBalance: 445000,
    channel: 'Direct',
    status: 'Rolled to D7-15',
    fimrTagged: false,
    rollDirection: 'Stable',
    lastPaymentDate: '2024-09-15',
  },
  {
    loanId: 'LN-2024-111',
    officerName: 'Grace Okon',
    region: 'Abuja',
    branch: 'Abuja Central',
    customerName: 'Emeka Obi',
    customerPhone: '+234-817-890-1234',
    disbursementDate: '2024-09-15',
    loanAmount: 310000,
    currentDPD: 1,
    previousDPDStatus: 'Current',
    daysInCurrentStatus: 1,
    amountDue: 38750,
    amountPaid: 0,
    outstandingBalance: 310000,
    channel: 'Partner',
    status: 'D1-3',
    fimrTagged: false,
    rollDirection: 'Worsening',
    lastPaymentDate: '2024-09-20',
  },
  {
    loanId: 'LN-2024-112',
    officerName: 'Musa Adebayo',
    region: 'Kano',
    branch: 'Kano North',
    customerName: 'Aisha Garba',
    customerPhone: '+234-709-012-3456',
    disbursementDate: '2024-08-28',
    loanAmount: 550000,
    currentDPD: 22,
    previousDPDStatus: 'D16-30',
    daysInCurrentStatus: 6,
    amountDue: 68750,
    amountPaid: 0,
    outstandingBalance: 550000,
    channel: 'Direct',
    status: 'Rolled to D16-30',
    fimrTagged: true,
    rollDirection: 'Worsening',
    lastPaymentDate: '2024-09-08',
  },
];

/**
 * Mock team members for audit assignment (to be fetched from backend)
 */
export const mockTeamMembers = [
  { id: 0, name: 'Unassigned', role: '' },
  { id: 'me', name: 'Assigned to Me', role: 'Current User' },
  { id: 1, name: 'Assigned to John Smith', role: 'Senior Auditor' },
  { id: 2, name: 'Assigned to Sarah Johnson', role: 'Audit Manager' },
  { id: 3, name: 'Assigned to Michael Chen', role: 'Risk Analyst' },
  { id: 4, name: 'Assigned to Amina Bello', role: 'Compliance Officer' },
  { id: 5, name: 'Assigned to David Okafor', role: 'Portfolio Manager' },
];

/**
 * Mock data for Agent Performance Drilldown - Officer-level performance metrics
 * This uses the existing officers data but formats it for the drilldown view
 */
export const mockAgentPerformance = mockOfficers.map((officer, index) => {
  // Calculate All-Time FIMR (higher than current FIMR - includes all loans ever disbursed)
  const allTimeFimrValues = [0.085, 0.152, 0.118]; // 8.5%, 15.2%, 11.8%
  const assignees = ['Assigned to Sarah Johnson', 'Assigned to Me', 'Unassigned'];
  const auditStatuses = ['In Progress', 'Assigned', 'Resolved'];
  const lastAuditDates = ['2024-10-15', '2024-09-22', null];

  return {
    officerName: officer.name,
    region: officer.region,
    branch: officer.branch,
    riskScore: officer.riskScore,
    riskBand: officer.riskBand,
    assignee: assignees[index],
    auditStatus: auditStatuses[index],
    lastAuditDate: lastAuditDates[index],
    ayr: officer.ayr,
    dqi: officer.dqi,
    fimr: officer.fimr,
    allTimeFimr: allTimeFimrValues[index],
    d06Slippage: officer.d06Slippage,
    roll: officer.roll,
    frr: officer.frr,
    portfolioTotal: officer.totalPortfolio,
    overdue15d: officer.overdue15d,
    activeLoans: officer.disbursed, // Using disbursed as proxy for active loans
    channel: officer.channel,
    yield: officer.yield,
    porr: officer.porr,
    channelPurity: officer.channelPurity,
    rank: officer.rank,
  };
});

/**
 * Mock data for Credit Health by Branch - Branch-level aggregated metrics
 */
export const mockBranchData = [
  {
    branch: 'Lagos Main',
    region: 'Lagos',
    portfolioTotal: 50000000,
    overdue15d: 1200000,
    par15Ratio: 0.024, // 2.4%
    ayr: 1.85,
    dqi: 92,
    fimr: 0.030, // 3.0%
    activeLoans: 5000,
    totalOfficers: 1,
  },
  {
    branch: 'Abuja Central',
    region: 'Abuja',
    portfolioTotal: 45000000,
    overdue15d: 2800000,
    par15Ratio: 0.062, // 6.2%
    ayr: 1.42,
    dqi: 78,
    fimr: 0.067, // 6.7%
    activeLoans: 4200,
    totalOfficers: 1,
  },
  {
    branch: 'Kano North',
    region: 'Kano',
    portfolioTotal: 35000000,
    overdue15d: 4200000,
    par15Ratio: 0.120, // 12.0%
    ayr: 1.08,
    dqi: 62,
    fimr: 0.111, // 11.1%
    activeLoans: 3800,
    totalOfficers: 1,
  },
];

